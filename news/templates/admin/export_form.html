<!-- news/templates/admin/export_form.html -->
{% extends "admin/base_site.html" %}

{% block content %}
<h2>Экспорт данных в XLSX</h2>

<form method="get">
    <div class="mb-3">
        <label>Выберите таблицу:</label>
        <select name="model" onchange="this.form.submit()" class="form-select">
            <option value="">-- Выберите --</option>
            {% for name, verbose_name in model_choices %}
                <option value="{{ name }}" {% if name == selected_model %}selected{% endif %}>
                    {{ verbose_name }}
                </option>
            {% endfor %}
        </select>
    </div>
</form>

{% if selected_model and fields %}
<form method="post">
    {% csrf_token %}
    <input type="hidden" name="model" value="{{ selected_model }}">
    <div class="mb-3">
        <label>Выберите поля для экспорта:</label><br>
        {% for field in fields %}
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="fields" value="{{ field }}" id="field_{{ field }}" checked>
                <label class="form-check-label" for="field_{{ field }}">{{ field }}</label>
            </div>
        {% endfor %}
    </div>
    <button type="submit" class="btn btn-success">Скачать XLSX</button>
</form>
{% endif %}

{% endblock %}